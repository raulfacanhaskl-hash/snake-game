<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Snake Game</title>

<style>
body {
    margin: 0;
    min-height: 100vh;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
}

.container {
    text-align: center;
}

canvas {
    background: #000;
    border: 3px solid #0f0;
    display: block;
    margin: 10px auto;
}

button {
    padding: 10px 15px;
    font-size: 16px;
    margin: 5px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

.menu, .gameover {
    margin-top: 10px;
}

.color-btn {
    width: 40px;
    height: 40px;
}

.controls {
    margin-top: 10px;
    display: grid;
    grid-template-columns: 60px 60px 60px;
    gap: 5px;
    justify-content: center;
}
.controls button {
    height: 60px;
    font-size: 20px;
}
</style>
</head>

<body>

<div class="container">

<h2>üêç Snake</h2>

<div class="menu" id="menu">
    <p>Escolha a cor da cobra:</p>
    <button class="color-btn" style="background:#0f0" onclick="setColor('#0f0')"></button>
    <button class="color-btn" style="background:#0ff" onclick="setColor('#0ff')"></button>
    <button class="color-btn" style="background:#f0f" onclick="setColor('#f0f')"></button>
    <button class="color-btn" style="background:#ff0" onclick="setColor('#ff0')"></button>
    <br><br>
    <button onclick="startGame()">‚ñ∂Ô∏è Jogar</button>
</div>

<canvas id="game" width="300" height="300" style="display:none"></canvas>

<p id="info"></p>

<div class="controls" id="touch" style="display:none">
    <div></div>
    <button onclick="setDir('up')">‚¨ÜÔ∏è</button>
    <div></div>
    <button onclick="setDir('left')">‚¨ÖÔ∏è</button>
    <button onclick="setDir('down')">‚¨áÔ∏è</button>
    <button onclick="setDir('right')">‚û°Ô∏è</button>
</div>

<div class="gameover" id="gameover" style="display:none">
    <h3>üíÄ Game Over</h3>
    <button onclick="startGame()">üîÅ Jogar novamente</button>
    <button onclick="backMenu()">üè† Menu</button>
</div>

</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const size = 15;

let snake = [];
let food;
let dir = "right";
let color = "#0f0";
let score = 0;
let record = localStorage.getItem("snakeRecord") || 0;
let loop;

function setColor(c) {
    color = c;
}

function backMenu() {
    clearInterval(loop);
    canvas.style.display = "none";
    document.getElementById("touch").style.display = "none";
    document.getElementById("gameover").style.display = "none";
    document.getElementById("menu").style.display = "block";
    document.getElementById("info").innerText = "";
}

function startGame() {
    document.getElementById("menu").style.display = "none";
    document.getElementById("gameover").style.display = "none";
    canvas.style.display = "block";
    document.getElementById("touch").style.display = "grid";

    snake = [];
    for (let i = 6; i > 0; i--) {
        snake.push({ x: i * size, y: 150 });
    }

    dir = "right";
    score = 0;
    food = spawnFood();

    clearInterval(loop);
    loop = setInterval(gameLoop, 120);
}

function spawnFood() {
    return {
        x: Math.floor(Math.random() * (canvas.width / size)) * size,
        y: Math.floor(Math.random() * (canvas.height / size)) * size
    };
}

function setDir(d) {
    const opposite = { up:"down", down:"up", left:"right", right:"left" };
    if (opposite[d] !== dir) dir = d;
}

document.addEventListener("keydown", e => {
    if (e.key === "ArrowUp" || e.key === "w") setDir("up");
    if (e.key === "ArrowDown" || e.key === "s") setDir("down");
    if (e.key === "ArrowLeft" || e.key === "a") setDir("left");
    if (e.key === "ArrowRight" || e.key === "d") setDir("right");
});

function gameLoop() {
    const head = {...snake[0]};

    if (dir === "up") head.y -= size;
    if (dir === "down") head.y += size;
    if (dir === "left") head.x -= size;
    if (dir === "right") head.x += size;

    if (
        head.x < 0 || head.y < 0 ||
        head.x >= canvas.width || head.y >= canvas.height ||
        snake.some(s => s.x === head.x && s.y === head.y)
    ) {
        gameOver();
        return;
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
        score++;
        food = spawnFood();
    } else {
        snake.pop();
    }

    draw();
}

function gameOver() {
    clearInterval(loop);
    if (score > record) {
        record = score;
        localStorage.setItem("snakeRecord", record);
    }
    document.getElementById("gameover").style.display = "block";
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "red";
    ctx.fillRect(food.x, food.y, size, size);

    snake.forEach((s, i) => {
        ctx.fillStyle = i === 0 ? color : "#0a0";
        ctx.fillRect(s.x, s.y, size, size);

        if (i === 0) {
            ctx.fillStyle = "black";
            ctx.fillRect(s.x + 3, s.y + 4, 3, 3);
            ctx.fillRect(s.x + 9, s.y + 4, 3, 3);
        }
    });

    document.getElementById("info").innerText =
        `Pontos: ${score} | Recorde: ${record}`;
}
</script>

</body>
</html>
